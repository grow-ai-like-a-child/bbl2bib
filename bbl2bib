#!/bin/bash
# Wrapper script for bbl2bib that automatically activates the virtual environment

# Get the directory where this script is located
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# Check if virtual environment exists
if [ ! -d "$SCRIPT_DIR/venv" ]; then
    echo "Virtual environment not found. Running setup..."
    echo ""
    
    # Run setup script
    if [ -f "$SCRIPT_DIR/setup.sh" ]; then
        bash "$SCRIPT_DIR/setup.sh"
    else
        echo "Error: setup.sh not found."
        echo "Please run the following commands to set up the environment:"
        echo "  cd $SCRIPT_DIR"
        echo "  python3 -m venv venv"
        echo "  source venv/bin/activate"
        echo "  pip install -e ."
        exit 1
    fi
fi

# Activate virtual environment
source "$SCRIPT_DIR/venv/bin/activate"

# Run the Python script with all arguments
python "$SCRIPT_DIR/bbl2bib.py" "$@"

# Deactivate virtual environment (optional, as the script exits anyway)
deactivate 2>/dev/null || true
